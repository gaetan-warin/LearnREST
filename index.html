<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REST Quest - Learn REST APIs Through Adventure!</title>
    <link rel="stylesheet" href="styles/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>

<body>
    <div id="app">
        <div class="game-container">
            <header class="game-header">
                <h1>REST Quest</h1>
                <div class="progress-bar">
                    <div class="progress" :style="{ width: progressWidth + '%' }"></div>
                </div>
            </header>

            <main class="game-content">
                <!-- Welcome Level -->
                <div v-if="currentLevel === 0" class="level">
                    <h2>Welcome to REST Quest!</h2>
                    <div class="character-dialog">
                        <div class="character">
                            <div class="character-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                        </div>
                        <div class="dialog-box">
                            <p>Greetings, brave explorer! I'm Professor REST, the head librarian of the Magical Library
                                of APIs. Our library is special - it responds to your requests through HTTP methods!</p>
                            <p>Today, I'll teach you how to interact with our mystical collection using the five sacred
                                HTTP methods. Are you ready to begin?</p>
                        </div>
                    </div>
                    <button class="action-button" @click="startJourney">Begin Adventure!</button>
                </div>

                <!-- GET Level -->
                <div v-if="currentLevel === 1" class="level">
                    <h2>The GET Method - Finding Treasures</h2>
                    <div class="character-dialog">
                        <div class="character">
                            <div class="character-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                        </div>
                        <div class="dialog-box">
                            <p>Ah, let's start with GET - the most basic and safest spell in our collection! Think of
                                GET like using a magical lens to read a book:</p>
                            <ul>
                                <li>It's <strong>read-only</strong> - you can't change the book by looking at it</li>
                                <li>It's <strong>safe</strong> - you can use it as many times as you want</li>
                                <li>It's <strong>idempotent</strong> - looking at the same book multiple times shows the
                                    same content</li>
                            </ul>
                            <p>Let's try viewing our collection!</p>
                        </div>
                    </div>
                    <div class="interactive-demo">
                        <button class="action-button" @click="handleGetAllBooks">GET /api/books</button>
                        <p class="demo-explanation">This spell reveals all books in our collection</p>
                        <div class="response-box">
                            <div v-if="apiResponse"
                                :class="['api-response', apiResponse.success ? 'success' : 'error']">
                                <p class="status">Status: {{ apiResponse.status }}</p>
                                <pre>{{ apiResponse.data }}</pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- POST Level -->
                <div v-if="currentLevel === 2" class="level">
                    <h2>The POST Method - Creating New Treasures</h2>
                    <div class="character-dialog">
                        <div class="character">
                            <div class="character-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                        </div>
                        <div class="dialog-box">
                            <p>Excellent! Now let's learn POST - the creation spell! POST is like writing a new book for
                                our library:</p>
                            <ul>
                                <li>It <strong>creates</strong> new resources</li>
                                <li>It's <strong>not idempotent</strong> - using it twice creates two different books
                                </li>
                                <li>All fields are <strong>required</strong> for creating a new book</li>
                            </ul>
                            <p>Try adding a new book to our collection!</p>
                        </div>
                    </div>
                    <div class="method-card post">
                        <h3>Create a New Book</h3>
                        <input type="text" v-model="newBook.title" placeholder="Book title (required)">
                        <input type="text" v-model="newBook.author" placeholder="Author (required)">
                        <input type="number" v-model="newBook.year" placeholder="Year (required)">
                        <button @click="handleCreateBook">POST /api/books</button>
                    </div>
                    <div class="response-box">
                        <div v-if="methodResponse"
                            :class="['api-response', methodResponse.success ? 'success' : 'error']">
                            <p class="status">Status: {{ methodResponse.status }}</p>
                            <pre>{{ methodResponse.data }}</pre>
                        </div>
                    </div>
                </div>

                <!-- PUT Level -->
                <div v-if="currentLevel === 3" class="level">
                    <h2>The PUT Method - Complete Transformations</h2>
                    <div class="character-dialog">
                        <div class="character">
                            <div class="character-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                        </div>
                        <div class="dialog-box">
                            <p>Now for PUT - the transformation spell! PUT is like replacing a book with a new edition:
                            </p>
                            <ul>
                                <li>It <strong>completely replaces</strong> the existing book</li>
                                <li>Only the <strong>title</strong> is required</li>
                                <li>Empty fields will <strong>remove</strong> those properties</li>
                                <li>It's <strong>idempotent</strong> - doing it multiple times has the same effect</li>
                            </ul>
                            <p>Unlike POST, you can choose which fields to keep or remove!</p>
                        </div>
                    </div>
                    <div class="method-card put">
                        <h3>Replace Existing Book</h3>
                        <input type="number" v-model="updateBook.id" placeholder="Book ID (required)">
                        <input type="text" v-model="updateBook.title" placeholder="New title (required)">
                        <input type="text" v-model="updateBook.author"
                            placeholder="New author (optional, empty to remove)">
                        <input type="number" v-model="updateBook.year"
                            placeholder="New year (optional, empty to remove)">
                        <button @click="handleUpdateBook">PUT /api/books/{id}</button>
                    </div>
                    <div class="response-box">
                        <div v-if="methodResponse"
                            :class="['api-response', methodResponse.success ? 'success' : 'error']">
                            <p class="status">Status: {{ methodResponse.status }}</p>
                            <pre>{{ methodResponse.data }}</pre>
                        </div>
                    </div>
                </div>

                <!-- PATCH Level -->
                <div v-if="currentLevel === 4" class="level">
                    <h2>The PATCH Method - Partial Updates</h2>
                    <div class="character-dialog">
                        <div class="character">
                            <div class="character-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                        </div>
                        <div class="dialog-box">
                            <p>Now we come to PATCH - the modification spell! PATCH is like editing specific pages in a
                                book:</p>
                            <ul>
                                <li>It makes <strong>partial modifications</strong></li>
                                <li>Only changes the fields you specify</li>
                                <li><strong>Preserves</strong> other fields</li>
                                <li>More <strong>efficient</strong> than PUT for small changes</li>
                            </ul>
                            <p>Let's try updating just the parts we want to change!</p>
                        </div>
                    </div>
                    <div class="method-card patch">
                        <h3>Update Book Fields</h3>
                        <input type="number" v-model="patchBook.id" placeholder="Book ID (required)">
                        <input type="text" v-model="patchBook.title" placeholder="New title (optional)">
                        <input type="text" v-model="patchBook.author" placeholder="New author (optional)">
                        <input type="number" v-model="patchBook.year" placeholder="New year (optional)">
                        <p class="field-note">Fill in only the fields you want to update - others will stay unchanged!
                        </p>
                        <button @click="handlePatchBook">PATCH /api/books/{id}</button>
                    </div>
                    <div class="response-box">
                        <div v-if="methodResponse"
                            :class="['api-response', methodResponse.success ? 'success' : 'error']">
                            <p class="status">Status: {{ methodResponse.status }}</p>
                            <pre>{{ methodResponse.data }}</pre>
                        </div>
                    </div>
                </div>

                <!-- DELETE Level -->
                <div v-if="currentLevel === 5" class="level">
                    <h2>The DELETE Method - Removing Resources</h2>
                    <div class="character-dialog">
                        <div class="character">
                            <div class="character-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                        </div>
                        <div class="dialog-box">
                            <p>Finally, we have DELETE - the vanishing spell! DELETE is like removing a book from our
                                collection:</p>
                            <ul>
                                <li>It <strong>removes</strong> the resource completely</li>
                                <li>It's <strong>idempotent</strong> - once gone, deleting again won't change anything
                                </li>
                                <li>The ID cannot be reused for new books</li>
                            </ul>
                            <p>Careful with this one - it's permanent!</p>
                        </div>
                    </div>
                    <div class="method-card delete">
                        <h3>Remove a Book</h3>
                        <input type="number" v-model="deleteBookId" placeholder="Book ID">
                        <button @click="handleDeleteBook">DELETE /api/books/{id}</button>
                    </div>
                    <div class="response-box">
                        <div v-if="methodResponse"
                            :class="['api-response', methodResponse.success ? 'success' : 'error']">
                            <p class="status">Status: {{ methodResponse.status }}</p>
                            <pre>{{ methodResponse.data }}</pre>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Current Library State -->
            <div class="library-state" v-if="currentLevel > 0">
                <h3>Current Library State</h3>
                <div class="books-table" v-if="books.length > 0">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Year</th>
                                <th>Available</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="book in books" :key="book.id">
                                <td>{{ book.id }}</td>
                                <td>{{ book.title }}</td>
                                <td>{{ book.author || '-' }}</td>
                                <td>{{ book.year || '-' }}</td>
                                <td>{{ book.available ? '‚úÖ' : '‚ùå' }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div v-else class="empty-state">
                    <p>The library shelves are empty. Time to add some books!</p>
                </div>
            </div>

            <footer class="game-footer">
                <div class="controls">
                    <button class="nav-button" :disabled="currentLevel === 0" @click="previousLevel">Previous</button>
                    <button class="nav-button" :disabled="!canAdvance" @click="nextLevel">Next</button>
                </div>
            </footer>
        </div>
    </div>
    <script type="module" src="js/app.js"></script>
</body>

</html>